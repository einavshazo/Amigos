@model IEnumerable<Naot_Lemida_Manage_V2.Models.City>

@{
    ViewBag.Title = "רשימת ערים";
}

<h2>רשימת ערים</h2>

<p>
    @Html.ActionLink("ליצור עיר חדשה", "Create","Cities", new { }, new { @class = "viewDialog", data_dialog_title = "יצירת עיר חדשה " })
</p>

@section Scripts {
<script>
    $(document).ready(function () {

        $.ajaxSetup({ cache: false });

        $(".viewDialog").on("click", function (e) {

            e.preventDefault();
            $("<div id='dialogContent'></div>")
                .addClass("dialog")
                .appendTo("body")
                .dialog({
                    title: $(this).attr("data-dialog-title"),
                    modal: true,
                    width: 300,
                    height: 350,
                    buttons: {
                        "Сохранить": function () {
                            $.ajax({
                                url: "@Url.Action("Create", "Cities")",
                                type: "POST",
                                data: $('form').serialize(),
                                datatype: "json",
                                success: function (result) {
 
                                    $("#dialogContent").html(result);
                                }
                            });
                        }
                    },

                    show:
                    {
                        effect: 'clip',
                        duration: 450
                    },
                    hide:{
                        effect: 'clip',
                        duration: 450
                    },
                    showOpt: { direction: 'up' }
                })
                .load(this.href);
        });
        $(".close").on("click", function (e) {
            e.preventDefault();
            $(this).closest(".dialog").dialog("close");
        });
    });
</script>


<script src='@Url.Content("~/Scripts/jquery-1.10.2.min.js")' type="text/javascript"></script>
<script src='@Url.Content("~/Scripts/jquery-ui-1.11.4.min.js")' type="text/javascript"></script>
}

<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Name)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
       
        <td>
            @Html.DisplayFor(modelItem => item.Name)
        </td>
        <td>

            @Html.ActionLink("ערוך", "Edit", "Cities", new { id = item.ID }, new { @class = "viewDialog", data_dialog_title = "עריכת פרטי העיר" }) |
            @Html.ActionLink("מחק", "Delete", "Cities", new { id = item.ID }, new { @class = "viewDialog", data_dialog_title = "מחיקת עיר" })
        </td>
    </tr>
}

</table>
